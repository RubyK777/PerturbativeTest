<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Profile Summary</title></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><title>Function details for eigs&gt;robustReorthogonalize</title><link rel="stylesheet" href="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">eigs&gt;robustReorthogonalize (Calls: 37013530, Time: 701.830 s)</span><br/><i>Generated 27-Mar-2021 21:45:39 using performance time.</i><br/>subfunction in file /Applications/MATLAB_R2018b.app/toolbox/matlab/sparfun/eigs.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Name</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Type</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file36.html">eigs&gt;KSherm</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">37013530</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Line Number</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Code</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Total Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">% Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line1632">1632</a></td><td class="td-linebottomrt"><pre>[projr, dw] = matlab.internal....</pre></td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">306.048 s</td><td class="td-linebottomrt" class="td-linebottomrt">43.6%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=44 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1635">1635</a></td><td class="td-linebottomrt"><pre>normRes = sqrt(abs(r'*(applyM(...</pre></td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">95.661 s</td><td class="td-linebottomrt" class="td-linebottomrt">13.6%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=14 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1623">1623</a></td><td class="td-linebottomrt"><pre>normr0 = sqrt(abs(r'*(applyM(r...</pre></td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">82.059 s</td><td class="td-linebottomrt" class="td-linebottomrt">11.7%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=12 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1626">1626</a></td><td class="td-linebottomrt"><pre>wIn = zeros(index,1);</pre></td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">47.257 s</td><td class="td-linebottomrt" class="td-linebottomrt">6.7%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1690">1690</a></td><td class="td-linebottomrt"><pre>end</pre></td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">41.309 s</td><td class="td-linebottomrt" class="td-linebottomrt">5.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">129.497 s</td><td class="td-linebottomrt">18.5%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=18 height=10></td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Totals</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">701.830 s</td><td class="td-linebottomrt" style="background-color:#F0F0F0">100%</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file38.html">eigs&gt;@(v)v</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">112114306</td><td class="td-linebottomrt">102.507 s</td><td class="td-linebottomrt">14.6%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=15 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">599.323 s</td><td class="td-linebottomrt">85.4%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=85 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">701.830 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/>No Code Analyzer messages.<div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Total lines in function</td><td class="td-linebottomrt">71</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">23</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">48</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">24</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">24</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">50.00 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table id="FunctionListingTable"><tr style="height:20px;"><th><pre><span style="color:#FF0000;">time</span> </pre></th><th><pre><span style="color:#0000FF;">Calls</span> </pre></th><th class="leftAligned" COLSPAN=2><pre><span> line</span></pre></th></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1620</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">function [r, normRes, stopAlgorithm, w] = robustReorthogonalize(V, r, ...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1621</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    applyM, index, randStr, wIn)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1622</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 82.059 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1623</span><a name="Line1623"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">normr0 = sqrt(abs(r'*(applyM(r)))); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1624</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.356 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1625</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if nargin &lt; 6 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 47.257 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1626</span><a name="Line1626"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">    wIn = zeros(index,1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.817 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1627</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.826 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1628</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">w = wIn; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1629</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.898 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1630</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">stopAlgorithm = false; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1631</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Reorthogonalize:</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 306.048 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1632</span><a name="Line1632"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FF8080; padding:1px;">[projr, dw] = matlab.internal.math.projectInto(V, applyM(r), index); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 13.985 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1633</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">r = r - projr; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 20.557 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1634</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">w = w + dw; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 95.661 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1635</span><a name="Line1635"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFD4D4; padding:1px;">normRes = sqrt(abs(r'*(applyM(r)))); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1636</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.712 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1637</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">numReorths = 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.910 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1638</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">while normRes &lt;= (1/sqrt(2))*normr0 &amp;&amp; numReorths &lt; 5 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.222 </span></pre></td><td><pre><span style="color: #0000FF"> 536858 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1639</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    [projr, dw] = matlab.internal.math.projectInto(V, applyM(r), index); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.286 </span></pre></td><td><pre><span style="color: #0000FF"> 536858 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1640</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    r = r - projr; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.178 </span></pre></td><td><pre><span style="color: #0000FF"> 536858 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1641</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    w = w + dw; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.035 </span></pre></td><td><pre><span style="color: #0000FF"> 536858 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1642</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    normr0 = normRes; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.562 </span></pre></td><td><pre><span style="color: #0000FF"> 536858 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1643</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    normRes = sqrt(abs(r'*(applyM(r)))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.028 </span></pre></td><td><pre><span style="color: #0000FF"> 536858 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1644</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    numReorths = numReorths + 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.060 </span></pre></td><td><pre><span style="color: #0000FF"> 536858 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1645</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1646</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.219 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1647</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if normRes &lt;= (1/sqrt(2))*normr0 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1648</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Cannot Reorthogonalize, invariant subspace found.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1649</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    normRes = 0;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1650</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    w = wIn;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1651</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1652</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Try a random restart</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1653</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    stopAlgorithm = true;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1654</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1655</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    for restart=1:3</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1656</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % Do a random restart: Will try at most three times</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1657</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        r = randn(randStr, size(r,1), 1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1658</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1659</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % Orthogonalize r</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1660</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        r = r - matlab.internal.math.projectInto(V, applyM(r), index);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1661</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        rMr = sqrt(abs(r'*applyM(r)));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1662</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        r = r / rMr;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1663</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1664</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % Re-orthogonalize if necessary</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1665</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        stopAlgorithm = true;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1666</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        for reorth=1:5</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1667</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1668</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Check orthogonality</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1669</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            Mr = applyM(r);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1670</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            [projr, VMr] = matlab.internal.math.projectInto(V, Mr, index);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1671</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            rMr = sqrt(abs(r'*Mr));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1672</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1673</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            if abs(rMr - 1) &lt;= 1e-10 &amp;&amp; all(abs(VMr) &lt;= 1e-10)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1674</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                stopAlgorithm = false;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1675</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                break;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1676</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1677</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1678</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Re-orthogonalize</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1679</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            r = r - projr;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1680</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            r = r / sqrt(abs(r'*applyM(r)));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1681</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1682</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1683</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        if ~stopAlgorithm</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1684</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            break;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1685</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1686</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.980 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1687</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 11.890 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1688</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    r = r/normRes; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.735 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1689</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 41.309 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1690</span><a name="Line1690"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">end </span><br/></pre></td></tr></table><p><p>Other subfunctions in this file are not included in this listing.</body></html>