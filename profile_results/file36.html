<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Profile Summary</title></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><title>Function details for eigs&gt;KSherm</title><link rel="stylesheet" href="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">eigs&gt;KSherm (Calls: 1458081, Time: 1650.022 s)</span><br/><i>Generated 27-Mar-2021 21:45:39 using performance time.</i><br/>subfunction in file /Applications/MATLAB_R2018b.app/toolbox/matlab/sparfun/eigs.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Name</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Type</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file35.html">eigs&gt;KrylovSchur</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">1458081</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Line Number</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Code</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Total Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">% Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line1374">1374</a></td><td class="td-linebottomrt"><pre>[r, normRes, stopAlgorithm] = ...</pre></td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">757.339 s</td><td class="td-linebottomrt" class="td-linebottomrt">45.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=46 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1391">1391</a></td><td class="td-linebottomrt"><pre>H = blkdiag(diag(d), H1);</pre></td><td class="td-linebottomrt">2243272</td><td class="td-linebottomrt">145.355 s</td><td class="td-linebottomrt" class="td-linebottomrt">8.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=9 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1361">1361</a></td><td class="td-linebottomrt"><pre>r = applyOP(Mv);</pre></td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">129.209 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1406">1406</a></td><td class="td-linebottomrt"><pre>[U, d] = eig(H, 'vector');</pre></td><td class="td-linebottomrt">2243272</td><td class="td-linebottomrt">122.495 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.4%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1385">1385</a></td><td class="td-linebottomrt"><pre>Alpha = [Alpha, alpha]; %#ok&l...</pre></td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">84.013 s</td><td class="td-linebottomrt" class="td-linebottomrt">5.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">411.612 s</td><td class="td-linebottomrt">24.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=25 height=10></td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Totals</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">1650.022 s</td><td class="td-linebottomrt" style="background-color:#F0F0F0">100%</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file37.html">eigs&gt;robustReorthogonalize</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">37013530</td><td class="td-linebottomrt">701.830 s</td><td class="td-linebottomrt">42.5%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=43 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file40.html">blkdiag</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2243272</td><td class="td-linebottomrt">135.707 s</td><td class="td-linebottomrt">8.2%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file39.html">eigs&gt;@(u)A*u</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">38471611</td><td class="td-linebottomrt">100.714 s</td><td class="td-linebottomrt">6.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file38.html">eigs&gt;@(v)v</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">42172964</td><td class="td-linebottomrt">42.234 s</td><td class="td-linebottomrt">2.6%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file41.html">eigs&gt;whichEigenvalues</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">2243272</td><td class="td-linebottomrt">36.373 s</td><td class="td-linebottomrt">2.2%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">633.164 s</td><td class="td-linebottomrt">38.4%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2018b.app/toolbox/matlab/codetools/private/one-pixel.gif" width=38 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">1650.022 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/>No Code Analyzer messages.<div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Total lines in function</td><td class="td-linebottomrt">146</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">47</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">99</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">81</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">18</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">81.82 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table id="FunctionListingTable"><tr style="height:20px;"><th><pre><span style="color:#FF0000;">time</span> </pre></th><th><pre><span style="color:#0000FF;">Calls</span> </pre></th><th class="leftAligned" COLSPAN=2><pre><span> line</span></pre></th></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1320</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">function [U, d, isNotConverged, stopAlgorithm] = KSherm(applyOP, applyM, n, k, ...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1321</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    innerOpts, randStr, shiftAndInvert)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1322</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Applies Krylov Schur algorithm for Hermitian matrices (reference 1)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1323</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1324</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Get previously set algorithm options</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.005 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1325</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">maxit = innerOpts.maxit; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.375 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1326</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">tol = innerOpts.tol; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.414 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1327</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">p = innerOpts.p; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.385 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1328</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">method = innerOpts.method; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1329</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1330</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Initialize variables</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  5.547 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1331</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">V = zeros(n, p); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.552 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1332</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">v = innerOpts.v0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.137 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1333</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">stopAlgorithm = false; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.092 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1334</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">k0 = k; % k0 is original k. (variable k will be adaptively increased) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.120 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1335</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">Alpha = []; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.109 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1336</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">Beta = []; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.118 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1337</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">d = []; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.165 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1338</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">c = []; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.133 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1339</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">normRes = []; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.079 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1340</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">justRestarted = false; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.084 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1341</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">sizeV = 1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1342</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1343</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Do one step of power iteration</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 16.874 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1344</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">v = applyOP(applyM(v)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1345</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  6.266 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1346</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">normv = sqrt(abs(v'*(applyM(v)))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.379 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1347</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">v = v / normv; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.726 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1348</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">normv = sqrt(abs(v'*(applyM(v)))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.128 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1349</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if ~(abs(normv - 1) &lt; 1e-10) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1350</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    v = innerOpts.v0;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1351</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1352</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1353</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1354</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Begin Main Algorithm</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.192 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1355</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for mm=1:maxit </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1356</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1357</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Build Krylov subspace in V, H:</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.245 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1358</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for jj = sizeV : p </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 22.525 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1359</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        V(:,jj) = v; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 82.701 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1360</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">        Mv = applyM(v); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 129.209 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1361</span><a name="Line1361"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">        r = applyOP(Mv); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 23.387 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1362</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        alpha = real(Mv'*r); % to make sure H is Hermitian </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1363</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.559 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1364</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        if jj == 1 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.378 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1365</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            r = r - alpha*v; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.981 </span></pre></td><td><pre><span style="color: #0000FF">35555449 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1366</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        elseif justRestarted </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1367</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % Do r = r - V(:,1:jj)*V(:,1:jj)'*applyM(r)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 10.831 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1368</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            r = r - matlab.internal.math.projectInto(V, applyM(r), jj); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.072 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1369</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            justRestarted = false; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.650 </span></pre></td><td><pre><span style="color: #0000FF">34770258 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1370</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 41.209 </span></pre></td><td><pre><span style="color: #0000FF">34770258 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1371</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            r = r - alpha*v - normRes*V(:, jj-1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.655 </span></pre></td><td><pre><span style="color: #0000FF">35555449 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1372</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1373</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 757.339 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1374</span><a name="Line1374"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FF8080; padding:1px;">        [r, normRes, stopAlgorithm] = <a href="file37.html">robustReorthogonalize</a>(V, r, applyM, jj, randStr); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1375</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.431 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1376</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        if stopAlgorithm </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1377</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            U = [];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1378</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            d = [];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1379</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            isNotConverged = false(0,1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1380</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            return;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1381</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1382</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1383</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % Save data</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.113 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1384</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        v = r; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 84.013 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1385</span><a name="Line1385"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">        Alpha = [Alpha, alpha]; %#ok&lt;AGROW&gt; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 45.465 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1386</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        Beta = [Beta, normRes];%#ok&lt;AGROW&gt; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.744 </span></pre></td><td><pre><span style="color: #0000FF">37013530 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1387</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1388</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1389</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Build matrix H</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 12.326 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1390</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    H1 = diag(Alpha) + diag(Beta(1:end-1), 1) + diag(Beta(1:end-1), -1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 145.355 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1391</span><a name="Line1391"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">    H = <a href="file40.html">blkdiag</a>(diag(d), H1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.217 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1392</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if ~isempty(d) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.400 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1393</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        H( 1:k , k+1 ) = c'; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.109 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1394</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        H( k+1 , 1: k ) = c; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.073 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1395</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.735 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1396</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    Alpha = []; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.480 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1397</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    Beta = []; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1398</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1399</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Check that values are finite (infs and NaNs rarely occur due to</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1400</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % random restarts)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 15.933 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1401</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if ~all(isfinite(H(:))) || ~all(isfinite(V(:))) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1402</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        error(message('MATLAB:eigs:VeryBadCondition'))</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1403</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1404</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1405</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Compute eigenvalues</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 122.495 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1406</span><a name="Line1406"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">    [U, d] = eig(H, 'vector'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1407</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1408</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Implicitly calculate residuals</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.646 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1409</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    res = abs(normRes * U(end, :)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1410</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1411</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Sort eigenvalues and residuals</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 42.657 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1412</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ind = <a href="file41.html">whichEigenvalues</a>(d, method); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  8.052 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1413</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    d = d(ind); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.389 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1414</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    res = res(ind); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1415</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1416</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Number of converged eigenpairs:</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.801 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1417</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    isNotConverged = ~(res(1:k0)' &lt; tol*max(eps^(2/3), abs(d(1:k0)))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.042 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1418</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    nconv = nnz(~isNotConverged); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1419</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.573 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1420</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if innerOpts.disp </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1421</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        minrelres = min(res(isNotConverged)' ./ max(eps^(2/3), ...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1422</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            abs(d(isNotConverged))));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1423</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        displayIteration(mm, maxit, nconv, k0, minrelres, tol);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1424</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1425</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.349 </span></pre></td><td><pre><span style="color: #0000FF">2243272 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1426</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if nconv &gt;= k0 || mm == maxit </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1427</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % Stop the algorithm now</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.156 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1428</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        break; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.070 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1429</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    else </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1430</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % Adjust k to prevent stagnating (see reference 2)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.073 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1431</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        k = k0 + min(nconv, floor((p - k0) / 2)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.101 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1432</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        if k == 1 &amp;&amp; p &gt; 3 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.049 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1433</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            k = floor(p / 2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.066 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1434</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.043 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1435</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1436</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1437</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Find k most desired eigenvalues of d</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.635 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1438</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ind = ind(1:k); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.029 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1439</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    U = U(:,ind); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1440</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1441</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Store variables for next iteration</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  7.066 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1442</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    V(:,1:k) = V*U; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.841 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1443</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    d = d(1:k); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.474 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1444</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    c = normRes * U(end, :); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.067 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1445</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    justRestarted = true; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.080 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1446</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    sizeV = k + 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.065 </span></pre></td><td><pre><span style="color: #0000FF"> 785191 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1447</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1448</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.875 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1449</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">U = U(:, ind(1:k0)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.800 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1450</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">d = d(1:k0); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.061 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1451</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">isNotConverged = isNotConverged(1:k0); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1452</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.239 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1453</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if shiftAndInvert </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1454</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Implicit extra step of power iteration (see reference 2)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1455</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    c = normRes * U(end, ~isNotConverged);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1456</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    U = V*U;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1457</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    UU = U(:,~isNotConverged).*d(~isNotConverged).' + v*c;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1458</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Renormalize</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1459</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    UU = UU./ sqrt(abs( sum(conj(UU).* applyM(UU), 1) ));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1460</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    U(:, ~isNotConverged) = UU;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.136 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1461</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.747 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1462</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    U = V*U; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.138 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1463</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1464</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  5.805 </span></pre></td><td><pre><span style="color: #0000FF">1458081 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1465</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr></table><p><p>Other subfunctions in this file are not included in this listing.</body></html>